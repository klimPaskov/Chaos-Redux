# Tuning constants:
# - `common/script_constants/chemical_warfare_constants.txt` (cbw_doom_decision / chem_doom_ai)
# - `common/script_constants/biowarfare_constants.txt` (bio_doom_ai)

chaosx_cbw_doom_category = {
    chem_unleash_stockpiled_cylinders = {
        icon = GFX_decision_chaos_doom
        cost = constant:cbw_doom_decision.defaults.pp_cost
        days_re_enable = constant:cbw_doom_decision.defaults.cooldown_days

        available = {
            has_government = fascism
            has_war = yes
            NOT = { has_capitulated = yes }
            surrender_progress > constant:cbw_doom_decision.defaults.surrender_threshold
            OR = {
                has_equipment = { chemical_chlorine_payload_cylinder_1 > 0 }
                has_equipment = { chemical_phosgene_payload_cylinder_1 > 0 }
                has_equipment = { chemical_mustard_payload_cylinder_1 > 0 }
                has_equipment = { chemical_lewisite_payload_cylinder_1 > 0 }
            }
        }

        ai_will_do = {
            base = constant:chem_doom_ai.defaults.base
            modifier = {
                add = constant:chem_doom_ai.defaults.add_base
                is_ai = yes
            }
            modifier = {
                add = constant:chem_doom_ai.defaults.add_high_morale
                check_variable = { stability > constant:chem_doom_ai.defaults.stability_threshold }
                check_variable = { war_support > constant:chem_doom_ai.defaults.war_support_threshold }
            }
            modifier = {
                add = constant:chem_doom_ai.defaults.add_big_stockpile
                OR = {
                    has_equipment = { chemical_chlorine_payload_cylinder_1 > constant:chem_doom_ai.defaults.stockpile_threshold }
                    has_equipment = { chemical_phosgene_payload_cylinder_1 > constant:chem_doom_ai.defaults.stockpile_threshold }
                    has_equipment = { chemical_mustard_payload_cylinder_1 > constant:chem_doom_ai.defaults.stockpile_threshold }
                    has_equipment = { chemical_lewisite_payload_cylinder_1 > constant:chem_doom_ai.defaults.stockpile_threshold }
                }
            }
        }

        complete_effect = {
            custom_effect_tooltip = chem_unleash_stockpiled_cylinders_tt
            hidden_effect = {
                chem_unleash_stockpile_doomsday = yes
            }
            news_event = { id = chaosx_cbw_doom.1 }
        }
    }

    bio_unleash_stockpiled_pathogens = {
        icon = GFX_decision_chaos_doom
        cost = constant:cbw_doom_decision.defaults.pp_cost
        days_re_enable = constant:cbw_doom_decision.defaults.cooldown_days

        available = {
            has_government = fascism
            has_war = yes
            NOT = { has_capitulated = yes }
            surrender_progress > constant:cbw_doom_decision.defaults.surrender_threshold
            OR = {
                has_equipment = { anthrax_bomb_1 > 0 }
                has_equipment = { plague_bomb_1 > 0 }
                has_equipment = { tularemia_bomb_1 > 0 }
                has_equipment = { smallpox_bomb_1 > 0 }
            }
        }

        ai_will_do = {
            base = constant:bio_doom_ai.defaults.base
            modifier = {
                add = constant:bio_doom_ai.defaults.add_base
                is_ai = yes
            }
            modifier = {
                add = constant:bio_doom_ai.defaults.add_high_morale
                check_variable = { stability > constant:bio_doom_ai.defaults.stability_threshold }
                check_variable = { war_support > constant:bio_doom_ai.defaults.war_support_threshold }
            }
            modifier = {
                add = constant:bio_doom_ai.defaults.add_big_stockpile
                OR = {
                    has_equipment = { anthrax_bomb_1 > constant:bio_doom_ai.defaults.stockpile_threshold }
                    has_equipment = { plague_bomb_1 > constant:bio_doom_ai.defaults.stockpile_threshold }
                    has_equipment = { tularemia_bomb_1 > constant:bio_doom_ai.defaults.stockpile_threshold }
                    has_equipment = { smallpox_bomb_1 > constant:bio_doom_ai.defaults.stockpile_threshold }
                }
            }
        }

        complete_effect = {
            custom_effect_tooltip = bio_unleash_stockpiled_pathogens_tt
            hidden_effect = {
                bio_unleash_stockpile_doomsday = yes
            }
            news_event = { id = chaosx_cbw_doom.2 }
        }
    }
}
