scripted_gui = {
    chaosx_settings_gui = {
        window_name = "chaosx_settings_window"
        context_type = player_context
        parent_window_token = top_bar

        visible = {
            has_country_flag = chaosx_settings_open
        }

        effects = {
            # Close button click - closes settings window
            close_button_click = {
                close_chaosx_settings = yes
            }

            # Menu button clicks (currently empty effects)
            trigger_events_button_click = {
                open_trigger_events_menu = yes
            }

            timer_system_button_click = {
                open_timer_system_menu = yes
            }

            chaos_meter_button_click = {
                open_chaos_meter_menu = yes
            }

            advanced_settings_button_click = {
                open_advanced_settings_menu = yes
            }

            reset_settings_button_click = {
                reset_all_settings = yes
            }

            toggle_scenarios_button_click = {
                toggle_scenarios_menu = yes
            }

            # Trigger Events Interface Effects
            events_header_left_arrow_click = {
                toggle_events_view = yes
            }

            events_header_right_arrow_click = {
                toggle_events_view = yes
            }

            event_id_decrease_click = {
                decrease_event_id = yes
            }

            event_id_decrease_right_click = {
                toggle_increment_mode = yes
            }

            event_id_increase_click = {
                increase_event_id = yes
            }

            event_id_increase_right_click = {
                toggle_increment_mode = yes
            }

            trigger_event_button_click = {
                trigger_selected_event = yes
            }

            trigger_random_event_button_click = {
                trigger_random_event = yes
            }

            show_events_log_checkbox_click = {
                toggle_events_log = yes
            }

            disable_event_system_checkbox_click = {
                toggle_event_system = yes
            }

            # Event Clusters Interface Effects
            clusters_header_left_arrow_click = {
                toggle_events_view = yes
            }

            clusters_header_right_arrow_click = {
                toggle_events_view = yes
            }
        }

        triggers = {
            # All menu buttons are always enabled
            trigger_events_button_click_enabled = {
                always = yes
            }

            timer_system_button_click_enabled = {
                always = yes
            }

            chaos_meter_button_click_enabled = {
                always = yes
            }

            advanced_settings_button_click_enabled = {
                always = yes
            }

            reset_settings_button_click_enabled = {
                always = yes
            }

            toggle_scenarios_button_click_enabled = {
                always = yes
            }

            close_button_click_enabled = {
                always = yes
            }

            # Trigger Events Interface Triggers
            events_header_left_arrow_click_enabled = {
                has_country_flag = show_trigger_events_menu
            }

            events_header_right_arrow_click_enabled = {
                has_country_flag = show_trigger_events_menu
            }

            event_id_decrease_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_decrease_right_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_increase_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_increase_right_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            trigger_event_button_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
                NOT = { check_variable = { var = global.settings_selected_event_id value = 0 compare = equals } }
            }

            trigger_random_event_button_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            show_events_log_checkbox_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            disable_event_system_checkbox_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            # Event Clusters Interface Triggers
            clusters_header_left_arrow_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_event_clusters_view
            }

            clusters_header_right_arrow_click_enabled = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_event_clusters_view
            }

            # Visibility triggers for trigger events content
            trigger_events_content_visible = {
                has_country_flag = show_trigger_events_menu
            }

            # Individual element visibility (only show when in Events view)
            events_header_left_arrow_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            events_header_right_arrow_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            events_header_text_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_label_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_decrease_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_increase_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_value_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }
            event_id_bg_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_id_increment_text_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_name_display_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            event_type_display_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            trigger_event_button_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            trigger_event_text_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            trigger_random_event_button_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            trigger_random_event_text_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            last_fired_header_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            last_fired_info_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            show_events_log_checkbox_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            show_events_log_text_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            disable_event_system_checkbox_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            disable_event_system_text_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_events_view
            }

            # Event Clusters visibility
            event_clusters_content_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_event_clusters_view
            }

            clusters_header_left_arrow_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_event_clusters_view
            }

            clusters_header_right_arrow_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_event_clusters_view
            }

            clusters_header_text_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_event_clusters_view
            }

            clusters_placeholder_visible = {
                has_country_flag = show_trigger_events_menu
                has_country_flag = show_event_clusters_view
            }
        }

        properties = {
            # Dynamic sprite properties for increment/decrement buttons based on increment mode
            event_id_decrease = {
                image = "[GetDecrementSprite]"
            }

            event_id_increase = {
                image = "[GetIncrementSprite]"
            }
        }

        ai_enabled = {
            always = no
        }
    }

    # Separate GUI for the settings button
    chaosx_settings_button_gui = {
        window_name = "chaosx_container"
        context_type = player_context
        parent_window_token = top_bar

        visible = {
            has_global_flag = event_system_initialized
        }

        effects = {
            # Settings button click - opens settings window
            chaosx_button_click = {
                open_chaosx_settings = yes
            }
        }

        triggers = {
            chaosx_button_click_enabled = {
                always = yes
            }
        }

        ai_enabled = {
            always = no
        }
    }
}
